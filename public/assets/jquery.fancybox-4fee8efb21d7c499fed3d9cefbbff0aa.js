/*
 * FancyBox - jQuery Plugin
 * Simple and fancy lightbox alternative
 *
 * Examples and documentation at: http://fancybox.net
 *
 * Copyright (c) 2008 - 2010 Janis Skarnelis
 * That said, it is hardly a one-person project. Many people have submitted bugs, code, and offered their advice freely. Their support is greatly appreciated.
 *
 * Version: 1.3.4 (11/11/2010)
 * Requires: jQuery v1.3+
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(t){var e,i,n,o,a,s,r,c,h,l,d,f,u,p=0,g={},v=[],y=0,b={},m=[],w=null,x=new Image,I=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,T=/[^\.]\.(swf)\s*$/i,A=1,k=0,C="",_=!1,O=t.extend(t("<div/>")[0],{prop:0}),D=t.browser.msie&&7>t.browser.version&&!window.XMLHttpRequest,j=function(){i.hide(),x.onerror=x.onload=null,w&&w.abort(),e.empty()},L=function(){return!1===g.onError(v,p,g)?(i.hide(),_=!1,void 0):(g.titleShow=!1,g.width="auto",g.height="auto",e.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),M(),void 0)},S=function(){var n,o,a,r,c,h,l=v[p];if(j(),g=t.extend({},t.fn.fancybox.defaults,"undefined"==typeof t(l).data("fancybox")?g:t(l).data("fancybox")),h=g.onStart(v,p,g),h===!1)return _=!1,void 0;if("object"==typeof h&&(g=t.extend(g,h)),a=g.title||(l.nodeName?t(l).attr("title"):l.title)||"",l.nodeName&&!g.orig&&(g.orig=t(l).children("img:first").length?t(l).children("img:first"):t(l)),""===a&&g.orig&&g.titleFromAlt&&(a=g.orig.attr("alt")),n=g.href||(l.nodeName?t(l).attr("href"):l.href)||null,(/^(?:javascript)/i.test(n)||"#"==n)&&(n=null),g.type?(o=g.type,n||(n=g.content)):g.content?o="html":n&&(o=n.match(I)?"image":n.match(T)?"swf":t(l).hasClass("iframe")?"iframe":0===n.indexOf("#")?"inline":"ajax"),!o)return L(),void 0;switch("inline"==o&&(l=n.substr(n.indexOf("#")),o=t(l).length>0?"inline":"ajax"),g.type=o,g.href=n,g.title=a,g.autoDimensions&&("html"==g.type||"inline"==g.type||"ajax"==g.type?(g.width="auto",g.height="auto"):g.autoDimensions=!1),g.modal&&(g.overlayShow=!0,g.hideOnOverlayClick=!1,g.hideOnContentClick=!1,g.enableEscapeButton=!1,g.showCloseButton=!1),g.padding=parseInt(g.padding,10),g.margin=parseInt(g.margin,10),e.css("padding",g.padding+g.margin),t(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){t(this).replaceWith(s.children())}),o){case"html":e.html(g.content),M();break;case"inline":if(t(l).parent().is("#fancybox-content")===!0)return _=!1,void 0;t('<div class="fancybox-inline-tmp" />').hide().insertBefore(t(l)).bind("fancybox-cleanup",function(){t(this).replaceWith(s.children())}).bind("fancybox-cancel",function(){t(this).replaceWith(e.children())}),t(l).appendTo(e),M();break;case"image":_=!1,t.fancybox.showActivity(),x=new Image,x.onerror=function(){L()},x.onload=function(){_=!0,x.onerror=x.onload=null,E()},x.src=n;break;case"swf":g.scrolling="no",r='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+g.width+'" height="'+g.height+'"><param name="movie" value="'+n+'"></param>',c="",t.each(g.swf,function(t,e){r+='<param name="'+t+'" value="'+e+'"></param>',c+=" "+t+'="'+e+'"'}),r+='<embed src="'+n+'" type="application/x-shockwave-flash" width="'+g.width+'" height="'+g.height+'"'+c+"></embed></object>",e.html(r),M();break;case"ajax":_=!1,t.fancybox.showActivity(),g.ajax.win=g.ajax.success,w=t.ajax(t.extend({},g.ajax,{url:n,data:g.ajax.data||{},error:function(t){t.status>0&&L()},success:function(t,o,a){var s="object"==typeof a?a:w;if(200==s.status){if("function"==typeof g.ajax.win){if(h=g.ajax.win(n,t,o,a),h===!1)return i.hide(),void 0;("string"==typeof h||"object"==typeof h)&&(t=h)}e.html(t),M()}}}));break;case"iframe":F()}},M=function(){var i=g.width,n=g.height;i=i.toString().indexOf("%")>-1?parseInt((t(window).width()-2*g.margin)*parseFloat(i)/100,10)+"px":"auto"==i?"auto":i+"px",n=n.toString().indexOf("%")>-1?parseInt((t(window).height()-2*g.margin)*parseFloat(n)/100,10)+"px":"auto"==n?"auto":n+"px",e.wrapInner('<div style="width:'+i+";height:"+n+";overflow: "+("auto"==g.scrolling?"auto":"yes"==g.scrolling?"scroll":"hidden")+';position:relative;"></div>'),g.width=e.width(),g.height=e.height(),F()},E=function(){g.width=x.width,g.height=x.height,t("<img />").attr({id:"fancybox-img",src:x.src,alt:g.title}).appendTo(e),F()},F=function(){var a,d;return i.hide(),o.is(":visible")&&!1===b.onCleanup(m,y,b)?(t.event.trigger("fancybox-cancel"),_=!1,void 0):(_=!0,t(s.add(n)).unbind(),t(window).unbind("resize.fb scroll.fb"),t(document).unbind("keydown.fb"),o.is(":visible")&&"outside"!==b.titlePosition&&o.css("height",o.height()),m=v,y=p,b=g,b.overlayShow?(n.css({"background-color":b.overlayColor,opacity:b.overlayOpacity,cursor:b.hideOnOverlayClick?"pointer":"auto",height:t(document).height()}),n.is(":visible")||(D&&t("select:not(#fancybox-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"}),n.show())):n.hide(),u=Q(),B(),o.is(":visible")?(t(r.add(h).add(l)).hide(),a=o.position(),f={top:a.top,left:a.left,width:o.width(),height:o.height()},d=f.width==u.width&&f.height==u.height,s.fadeTo(b.changeFade,.3,function(){var i=function(){s.html(e.contents()).fadeTo(b.changeFade,1,q)};t.event.trigger("fancybox-change"),s.empty().removeAttr("filter").css({"border-width":b.padding,width:u.width-2*b.padding,height:g.autoDimensions?"auto":u.height-k-2*b.padding}),d?i():(O.prop=0,t(O).animate({prop:1},{duration:b.changeSpeed,easing:b.easingChange,step:R,complete:i}))}),void 0):(o.removeAttr("style"),s.css("border-width",b.padding),"elastic"==b.transitionIn?(f=$(),s.html(e.contents()),o.show(),b.opacity&&(u.opacity=0),O.prop=0,t(O).animate({prop:1},{duration:b.speedIn,easing:b.easingIn,step:R,complete:q}),void 0):("inside"==b.titlePosition&&k>0&&c.show(),s.css({width:u.width-2*b.padding,height:g.autoDimensions?"auto":u.height-k-2*b.padding}).html(e.contents()),o.css(u).fadeIn("none"==b.transitionIn?0:b.speedIn,q),void 0)))},H=function(t){return t&&t.length?"float"==b.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+t+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+b.titlePosition+'">'+t+"</div>":!1},B=function(){if(C=b.title||"",k=0,c.empty().removeAttr("style").removeClass(),b.titleShow===!1)return c.hide(),void 0;if(C=t.isFunction(b.titleFormat)?b.titleFormat(C,m,y,b):H(C),!C||""===C)return c.hide(),void 0;switch(c.addClass("fancybox-title-"+b.titlePosition).html(C).appendTo("body").show(),b.titlePosition){case"inside":c.css({width:u.width-2*b.padding,marginLeft:b.padding,marginRight:b.padding}),k=c.outerHeight(!0),c.appendTo(a),u.height+=k;break;case"over":c.css({marginLeft:b.padding,width:u.width-2*b.padding,bottom:b.padding}).appendTo(a);break;case"float":c.css("left",-1*parseInt((c.width()-u.width-40)/2,10)).appendTo(o);break;default:c.css({width:u.width-2*b.padding,paddingLeft:b.padding,paddingRight:b.padding}).appendTo(o)}c.hide()},N=function(){return(b.enableEscapeButton||b.enableKeyboardNav)&&t(document).bind("keydown.fb",function(e){27==e.keyCode&&b.enableEscapeButton?(e.preventDefault(),t.fancybox.close()):37!=e.keyCode&&39!=e.keyCode||!b.enableKeyboardNav||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||"SELECT"===e.target.tagName||(e.preventDefault(),t.fancybox[37==e.keyCode?"prev":"next"]())}),b.showNavArrows?((b.cyclic&&m.length>1||0!==y)&&h.show(),(b.cyclic&&m.length>1||y!=m.length-1)&&l.show(),void 0):(h.hide(),l.hide(),void 0)},q=function(){t.support.opacity||(s.get(0).style.removeAttribute("filter"),o.get(0).style.removeAttribute("filter")),g.autoDimensions&&s.css("height","auto"),o.css("height","auto"),C&&C.length&&c.show(),b.showCloseButton&&r.show(),N(),b.hideOnContentClick&&s.bind("click",t.fancybox.close),b.hideOnOverlayClick&&n.bind("click",t.fancybox.close),t(window).bind("resize.fb",t.fancybox.resize),b.centerOnScroll&&t(window).bind("scroll.fb",t.fancybox.center),"iframe"==b.type&&t('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(t.browser.msie?'allowtransparency="true""':"")+' scrolling="'+g.scrolling+'" src="'+b.href+'"></iframe>').appendTo(s),o.show(),_=!1,t.fancybox.center(),b.onComplete(m,y,b),P()},P=function(){var t,e;m.length-1>y&&(t=m[y+1].href,"undefined"!=typeof t&&t.match(I)&&(e=new Image,e.src=t)),y>0&&(t=m[y-1].href,"undefined"!=typeof t&&t.match(I)&&(e=new Image,e.src=t))},R=function(t){var e={width:parseInt(f.width+(u.width-f.width)*t,10),height:parseInt(f.height+(u.height-f.height)*t,10),top:parseInt(f.top+(u.top-f.top)*t,10),left:parseInt(f.left+(u.left-f.left)*t,10)};"undefined"!=typeof u.opacity&&(e.opacity=.5>t?.5:t),o.css(e),s.css({width:e.width-2*b.padding,height:e.height-k*t-2*b.padding})},z=function(){return[t(window).width()-2*b.margin,t(window).height()-2*b.margin,t(document).scrollLeft()+b.margin,t(document).scrollTop()+b.margin]},Q=function(){var t,e=z(),i={},n=b.autoScale,o=2*b.padding;return i.width=b.width.toString().indexOf("%")>-1?parseInt(e[0]*parseFloat(b.width)/100,10):b.width+o,i.height=b.height.toString().indexOf("%")>-1?parseInt(e[1]*parseFloat(b.height)/100,10):b.height+o,n&&(i.width>e[0]||i.height>e[1])&&("image"==g.type||"swf"==g.type?(t=b.width/b.height,i.width>e[0]&&(i.width=e[0],i.height=parseInt((i.width-o)/t+o,10)),i.height>e[1]&&(i.height=e[1],i.width=parseInt((i.height-o)*t+o,10))):(i.width=Math.min(i.width,e[0]),i.height=Math.min(i.height,e[1]))),i.top=parseInt(Math.max(e[3]-20,e[3]+.5*(e[1]-i.height-40)),10),i.left=parseInt(Math.max(e[2]-20,e[2]+.5*(e[0]-i.width-40)),10),i},Y=function(t){var e=t.offset();return e.top+=parseInt(t.css("paddingTop"),10)||0,e.left+=parseInt(t.css("paddingLeft"),10)||0,e.top+=parseInt(t.css("border-top-width"),10)||0,e.left+=parseInt(t.css("border-left-width"),10)||0,e.width=t.width(),e.height=t.height(),e},$=function(){var e,i,n=g.orig?t(g.orig):!1,o={};return n&&n.length?(e=Y(n),o={width:e.width+2*b.padding,height:e.height+2*b.padding,top:e.top-b.padding-20,left:e.left-b.padding-20}):(i=z(),o={width:2*b.padding,height:2*b.padding,top:parseInt(i[3]+.5*i[1],10),left:parseInt(i[2]+.5*i[0],10)}),o},K=function(){return i.is(":visible")?(t("div",i).css("top",-40*A+"px"),A=(A+1)%12,void 0):(clearInterval(d),void 0)};t.fn.fancybox=function(e){return t(this).length?(t(this).data("fancybox",t.extend({},e,t.metadata?t(this).metadata():{})).unbind("click.fb").bind("click.fb",function(e){if(e.preventDefault(),!_){_=!0,t(this).blur(),v=[],p=0;var i=t(this).attr("rel")||"";i&&""!=i&&"nofollow"!==i?(v=t("a[rel="+i+"], area[rel="+i+"]"),p=v.index(this)):v.push(this),S()}}),this):this},t.fancybox=function(e){var i;if(!_){if(_=!0,i="undefined"!=typeof arguments[1]?arguments[1]:{},v=[],p=parseInt(i.index,10)||0,t.isArray(e)){for(var n=0,o=e.length;o>n;n++)"object"==typeof e[n]?t(e[n]).data("fancybox",t.extend({},i,e[n])):e[n]=t({}).data("fancybox",t.extend({content:e[n]},i));v=jQuery.merge(v,e)}else"object"==typeof e?t(e).data("fancybox",t.extend({},i,e)):e=t({}).data("fancybox",t.extend({content:e},i)),v.push(e);(p>v.length||0>p)&&(p=0),S()}},t.fancybox.showActivity=function(){clearInterval(d),i.show(),d=setInterval(K,66)},t.fancybox.hideActivity=function(){i.hide()},t.fancybox.next=function(){return t.fancybox.pos(y+1)},t.fancybox.prev=function(){return t.fancybox.pos(y-1)},t.fancybox.pos=function(t){_||(t=parseInt(t),v=m,t>-1&&m.length>t?(p=t,S()):b.cyclic&&m.length>1&&(p=t>=m.length?0:m.length-1,S()))},t.fancybox.cancel=function(){_||(_=!0,t.event.trigger("fancybox-cancel"),j(),g.onCancel(v,p,g),_=!1)},t.fancybox.close=function(){function e(){n.fadeOut("fast"),c.empty().hide(),o.hide(),t.event.trigger("fancybox-cleanup"),s.empty(),b.onClosed(m,y,b),m=g=[],y=p=0,b=g={},_=!1}if(!_&&!o.is(":hidden")){if(_=!0,b&&!1===b.onCleanup(m,y,b))return _=!1,void 0;if(j(),t(r.add(h).add(l)).hide(),t(s.add(n)).unbind(),t(window).unbind("resize.fb scroll.fb"),t(document).unbind("keydown.fb"),s.find("iframe").attr("src",D&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==b.titlePosition&&c.empty(),o.stop(),"elastic"==b.transitionOut){f=$();var i=o.position();u={top:i.top,left:i.left,width:o.width(),height:o.height()},b.opacity&&(u.opacity=1),c.empty().hide(),O.prop=1,t(O).animate({prop:0},{duration:b.speedOut,easing:b.easingOut,step:R,complete:e})}else o.fadeOut("none"==b.transitionOut?0:b.speedOut,e)}},t.fancybox.resize=function(){n.is(":visible")&&n.css("height",t(document).height()),t.fancybox.center(!0)},t.fancybox.center=function(){var t,e;_||(e=arguments[0]===!0?1:0,t=z(),(e||!(o.width()>t[0]||o.height()>t[1]))&&o.stop().animate({top:parseInt(Math.max(t[3]-20,t[3]+.5*(t[1]-s.height()-40)-b.padding)),left:parseInt(Math.max(t[2]-20,t[2]+.5*(t[0]-s.width()-40)-b.padding))},"number"==typeof arguments[0]?arguments[0]:200))},t.fancybox.init=function(){t("#fancybox-wrap").length||(t("body").append(e=t('<div id="fancybox-tmp"></div>'),i=t('<div id="fancybox-loading"><div></div></div>'),n=t('<div id="fancybox-overlay"></div>'),o=t('<div id="fancybox-wrap"></div>')),a=t('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(o),a.append(s=t('<div id="fancybox-content"></div>'),r=t('<a id="fancybox-close"></a>'),c=t('<div id="fancybox-title"></div>'),h=t('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),l=t('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),r.click(t.fancybox.close),i.click(t.fancybox.cancel),h.click(function(e){e.preventDefault(),t.fancybox.prev()}),l.click(function(e){e.preventDefault(),t.fancybox.next()}),t.fn.mousewheel&&o.bind("mousewheel.fb",function(e,i){_?e.preventDefault():(0==t(e.target).get(0).clientHeight||t(e.target).get(0).scrollHeight===t(e.target).get(0).clientHeight)&&(e.preventDefault(),t.fancybox[i>0?"prev":"next"]())}),t.support.opacity||o.addClass("fancybox-ie"),D&&(i.addClass("fancybox-ie6"),o.addClass("fancybox-ie6"),t('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(a)))},t.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},t(document).ready(function(){t.fancybox.init()})})(jQuery);